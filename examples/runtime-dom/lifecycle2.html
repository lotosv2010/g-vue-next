<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>lifecycle</title>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    // import { ref, render, h, Text } from '../../node_modules/vue/dist/vue.esm-browser.js'
    import { ref, render, h, Text } from '../../packages/vue/dist/vue.esm.js'

    const Modal = {
      setup(props, ctx) {
        return () => h('div', {}, [
          h('div', {}, 'modal')
        ])
      },
      beforeUnmount() {
        console.log('beforeUnmount')
      },
      unmounted() {
        console.log('unmount')
      },
    }

    const App = {
      setup(props, ctx) {
        const name = ref('test')
        const visible = ref(true)
        setTimeout(() => {
          name.value = 'test1'
        }, 1000);

        // 当返回一个对象时，会作为setup函数的返回值，此时this指向setup函数的返回值
        return () => {
          return h('div', {}, [
            h('h2', {}, `name: ${name.value}`),
            visible.value ? h(Modal, {visible: visible.value, name: 'modal'}) : null,
            h('button', { onClick: () => visible.value = !visible.value }, visible.value ? 'close' : 'open')
          ])
        }
      },
      beforeCreate() {
        console.log('beforeCreate')
      },
      created() {
        console.log('created')
      },
      beforeMount() {
        console.log('beforeMount')
      },
      mounted() {
        console.log('mounted')
      },
      beforeUpdate() {
        console.log('beforeUpdate')
      },
      updated() {
        console.log('updated')
      },
      beforeUnmount() {
        console.log('beforeUnmount')
      },
      unmounted() {
        console.log('unmount')
      },
    }

    render(h(App), document.querySelector('#app'))
  </script>
</body>
</html>